p8105_hw3_jg5038
================
Julia Gray
2025-10-02

Problem 1

``` r
data("instacart")

instacart_df = instacart |> 
  janitor::clean_names()

#order_dow is given as an integer but to make it human readable let's change it to a string. We don't know which day is which but in order to find out we can see the distribution by day and assume that the most orders happen on Saturday and Sunday

instacart_df |> 
  group_by(order_dow) |> 
  summarize(n = n_distinct(order_id))
```

    ## # A tibble: 7 × 2
    ##   order_dow     n
    ##       <int> <int>
    ## 1         0 27465
    ## 2         1 19672
    ## 3         2 16119
    ## 4         3 15687
    ## 5         4 15959
    ## 6         5 17406
    ## 7         6 18901

``` r
#Let's assume that people order the most groceries on Monday so dow 0 = Monday

instacart_df = instacart_df |> 
  mutate(order_dow_string = 
         case_match(
           order_dow, 
           0 ~ "Mon", 
           1 ~ "Tues",
           2 ~ "Weds",
           3 ~ "Thurs", 
           4 ~ "Fri",
           5 ~ "Sat",
           6 ~ "Sun"
         ))
```

This dataset contains order information from instacart. It is organized
by order and contains information about the products ordered, as well as
information about the customer (i.e. how long it’s been since they last
ordered). It contains 1384617 observations and includes columns for
order_id, product_id, add_to_cart_order, reordered, user_id, eval_set,
order_number, order_dow, order_hour_of_day, days_since_prior_order,
product_name, aisle_id, department_id, aisle, department. For example,
the first order in the dataset was made by 112108 at 10 o clock and we
can see they ordered c(“Bulgarian Yogurt”, “Organic 4% Milk Fat Whole
Milk Cottage Cheese”, “Organic Celery Hearts”, “Cucumber Kirby”,
“Lightly Smoked Sardines in Olive Oil”, “Bag of Organic Bananas”,
“Organic Hass Avocado”, “Organic Whole String Cheese”) (of which
c(“Bulgarian Yogurt”, “Organic 4% Milk Fat Whole Milk Cottage Cheese”,
“Lightly Smoked Sardines in Olive Oil”, “Organic Whole String Cheese”)
were reordered).

There are 134 unique aisles. Here is a table of the aisles most ordered
from (just showing the top 10):

``` r
instacart_aisle_sum_df = instacart_df |> 
  group_by(aisle) |> 
  summarize(
    n = n()
  ) |> 
  arrange(desc(n)) 

instacart_aisle_sum_df |> 
  head(10) |> 
  knitr::kable()
```

| aisle                         |      n |
|:------------------------------|-------:|
| fresh vegetables              | 150609 |
| fresh fruits                  | 150473 |
| packaged vegetables fruits    |  78493 |
| yogurt                        |  55240 |
| packaged cheese               |  41699 |
| water seltzer sparkling water |  36617 |
| milk                          |  32644 |
| chips pretzels                |  31269 |
| soy lactosefree               |  26240 |
| bread                         |  23635 |

Now let’s plot aisles with more than 10,000 items ordered from them:

``` r
#UPDATE labels and size to render correctly
instacart_aisle_sum_df |> 
  filter(n >= 10000) |> 
  ggplot(aes(x=reorder(aisle, n), y=n)) +
  geom_bar(stat="identity") +
  coord_flip()
```

<img src="p8105_hw3_jg5038_files/figure-gfm/unnamed-chunk-3-1.png" width="90%" />

In order to find the most popular items for each aisle let’s group by:

``` r
instacart_aisle_item_df = instacart_df |> 
  group_by(aisle) |> 
  count(product_name) |> 
  mutate(
    item_aisle_rank = min_rank(desc(n))
    ) |> 
  filter(aisle %in% c('baking ingredients', 'dog food care', 'packaged vegetables fruits'), item_aisle_rank <= 3) |> 
  arrange(aisle, item_aisle_rank)

knitr::kable(instacart_aisle_item_df)
```

| aisle                      | product_name                                  |    n | item_aisle_rank |
|:---------------------------|:----------------------------------------------|-----:|----------------:|
| baking ingredients         | Light Brown Sugar                             |  499 |               1 |
| baking ingredients         | Pure Baking Soda                              |  387 |               2 |
| baking ingredients         | Cane Sugar                                    |  336 |               3 |
| dog food care              | Snack Sticks Chicken & Rice Recipe Dog Treats |   30 |               1 |
| dog food care              | Organix Chicken & Brown Rice Recipe           |   28 |               2 |
| dog food care              | Small Dog Biscuits                            |   26 |               3 |
| packaged vegetables fruits | Organic Baby Spinach                          | 9784 |               1 |
| packaged vegetables fruits | Organic Raspberries                           | 5546 |               2 |
| packaged vegetables fruits | Organic Blueberries                           | 4966 |               3 |

To make a table showing the mean hour per day at which items are ordered
for each day of the week we will group by day and calculate the mean:

``` r
instacart_df |> 
  filter(product_name %in% c('Pink Lady Apples', 'Coffee Ice Cream')) |> 
  group_by (product_name, order_dow_string) |> 
  summarize(
    mean_order_hour_of_day = round(mean(order_hour_of_day, na.rm = TRUE), digits=2)
  ) |> 
  pivot_wider(
    names_from = order_dow_string,
    values_from = mean_order_hour_of_day
  ) |> 
  knitr::kable()
```

    ## `summarise()` has grouped output by 'product_name'. You can override using the
    ## `.groups` argument.

| product_name     |   Fri |   Mon |   Sat |   Sun | Thurs |  Tues |  Weds |
|:-----------------|------:|------:|------:|------:|------:|------:|------:|
| Coffee Ice Cream | 15.22 | 13.77 | 12.26 | 13.83 | 15.32 | 14.32 | 15.38 |
| Pink Lady Apples | 11.55 | 13.44 | 12.78 | 11.94 | 14.25 | 11.36 | 11.70 |
